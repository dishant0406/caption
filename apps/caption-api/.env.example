# =============================================================================
# Caption Bot API - Environment Configuration
# =============================================================================

# Node Environment
NODE_ENV=development

# Server Configuration
PORT=3000
HOST=0.0.0.0
API_PREFIX=/api/v1
REQUEST_TIMEOUT=30000

# =============================================================================
# Database Configuration
# =============================================================================
DATABASE_URL=postgresql://caption:caption_dev_password@localhost:5432/caption_db
DATABASE_SSL=false
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# =============================================================================
# Redis Configuration
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_CLUSTER_MODE=false

# =============================================================================
# WhatsApp Configuration
# =============================================================================
# Provider for receiving webhooks: 'evolution' or 'wasender'
WHATSAPP_PROVIDER=evolution
# Provider for sending messages: 'evolution' or 'wasender'
WHATSAPP_SENDER_PROVIDER=evolution

# Evolution API Configuration (default)
WHATSAPP_SERVER_URL=http://localhost:3001
WHATSAPP_SOCKET_URL=http://localhost:3001
WHATSAPP_API_KEY=your-whatsapp-api-key
WHATSAPP_INSTANCE=caption-bot

# WaSender API Configuration (alternative)
# Uncomment and configure if using WaSender
# WASENDER_SERVER_URL=https://www.wasenderapi.com
# WASENDER_SOCKET_URL=https://www.wasenderapi.com
# WASENDER_API_KEY=your-wasender-api-key
# WASENDER_SESSION_ID=your-session-id

# Bot phone number (E.164 format without +, e.g., 919876543210)
# Used to filter out webhook events from the bot's own number
BOT_PHONE_NUMBER=919876543210

# =============================================================================
# AI/LLM Configuration
# =============================================================================
# Provider: 'openai' or 'azure'
LLM_PROVIDER=openai

# OpenAI Configuration (if using OpenAI provider)
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4o

# Azure OpenAI Configuration (if using Azure provider)
AZURE_OPENAI_API_KEY=your-azure-openai-api-key
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com
AZURE_OPENAI_DEPLOYMENT=gpt-4o
AZURE_OPENAI_API_VERSION=2024-08-01-preview
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-ada-002

# =============================================================================
# Azure Blob Storage
# =============================================================================
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=...
AZURE_STORAGE_ACCOUNT=captionbotstorage
AZURE_STORAGE_KEY=your-azure-storage-key
AZURE_STORAGE_CONTAINER=caption-videos

# =============================================================================
# Logging Configuration
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=false
LOG_FILE_PATH=./logs/app.log

# =============================================================================
# Security Configuration
# =============================================================================
CORS_ORIGIN=*
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# Caption Session Configuration
# =============================================================================
SESSION_INACTIVITY_TIMEOUT=1800000
CHUNK_REVIEW_TIMEOUT=600000

# =============================================================================
# Video Processing Configuration
# =============================================================================
CHUNK_DURATION_SECONDS=20
MAX_VIDEO_DURATION_FREE=60
MAX_VIDEO_DURATION_PAID=300
MAX_FILE_SIZE_FREE=52428800
MAX_FILE_SIZE_PAID=209715200

# =============================================================================
# Input Guardrails Configuration
# =============================================================================
# Master switch - disable all guardrails
GUARDRAILS_ENABLED=true

# Unicode Normalization (fast, no LLM calls)
GUARDRAILS_UNICODE_NORMALIZER_ENABLED=true

# Spam Detection (fast, uses cache)
GUARDRAILS_SPAM_DETECTOR_ENABLED=true
GUARDRAILS_SPAM_MAX_PER_MINUTE=15
GUARDRAILS_SPAM_MAX_PER_HOUR=150

# Prompt Injection Detection (uses LLM - ~500ms)
GUARDRAILS_PROMPT_INJECTION_ENABLED=true
GUARDRAILS_PROMPT_INJECTION_THRESHOLD=0.7

# Content Moderation (uses LLM - ~500ms-1s)
GUARDRAILS_MODERATION_ENABLED=true
GUARDRAILS_MODERATION_THRESHOLD=0.8

# =============================================================================
# Polar.sh Payment Configuration
# =============================================================================
# Polar.sh API Configuration
POLAR_ACCESS_TOKEN=polar_at_your_access_token
POLAR_API_KEY=polar_sk_your_api_key_here
POLAR_WEBHOOK_SECRET=whsec_your_webhook_secret_here
POLAR_ORGANIZATION_ID=your_organization_id_here
POLAR_SERVER=production
POLAR_BASE_URL=https://api.polar.sh

# Application URLs
APP_URL=https://caption.bot

# Polar Product IDs for subscription tiers
# Get these from your Polar.sh dashboard after creating products
POLAR_STARTER_PRODUCT_ID=id-of-starter-product
POLAR_STARTER_PRICE_ID=id-of-starter-price
POLAR_PRO_PRODUCT_ID=id-of-pro-product
POLAR_PRO_PRICE_ID=id-of-pro-price
POLAR_UNLIMITED_PRODUCT_ID=id-of-unlimited-product
POLAR_UNLIMITED_PRICE_ID=id-of-unlimited-price